# Git Operations Module

Dieses Modul bietet eine vollst√§ndige Git-Integration f√ºr das PIDEA-Spark Automation System mit WorkspaceFinder-Unterst√ºtzung.

## üìÅ **Dateistruktur**

```
automation/git-operations/
‚îú‚îÄ‚îÄ find-git.js          # Git-Repository-Erkennung via CDP
‚îú‚îÄ‚îÄ run.js               # Haupt-Git-Operations-Manager
‚îú‚îÄ‚îÄ git-status.js        # Git-Status-Checker
‚îú‚îÄ‚îÄ git-branches.js      # Git-Branch-Management
‚îú‚îÄ‚îÄ git-commit.js        # Git-Commit-Operationen (add, commit, push, pull, fetch)
‚îú‚îÄ‚îÄ git-stash.js         # Git-Stash-Management
‚îú‚îÄ‚îÄ git-reset.js         # Git-Reset-Operationen (soft, hard, mixed)
‚îú‚îÄ‚îÄ git-remote.js        # Git-Remote-Management
‚îî‚îÄ‚îÄ README.md           # Diese Datei
```

## üéØ **Funktionen**

### **1. WorkspaceFinder-Integration**
- Automatische Erkennung des Cursor Workspace
- Git-Operationen im korrekten Repository
- Fallback auf lokales Verzeichnis

### **2. Git-Status-Checker (`git-status.js`)**
```javascript
const GitStatusChecker = new GitStatusChecker(workspacePath);
const status = await gitChecker.getStatus();
const branch = await gitChecker.getCurrentBranch();
const info = await gitChecker.getFullInfo();
```

**Features:**
- ‚úÖ Git-Repository-Erkennung
- üìä Detaillierter Status (modified, added, deleted, untracked)
- üåø Branch-Informationen
- üìù Commit-Historie
- üåê Remote-Repository-Info

### **3. Git-Branch-Manager (`git-branches.js`)**
```javascript
const GitBranchManager = new GitBranchManager(workspacePath);
const branches = await branchManager.getAllBranches();
const result = await branchManager.createBranch('feature/new-feature');
const result = await branchManager.switchBranch('main');
```

**Features:**
- üìã Alle Branches auflisten (local + remote)
- ‚ûï Neue Branches erstellen
- üîÑ Branch wechseln
- üóëÔ∏è Branches l√∂schen
- üîÄ Branches mergen
- üìä Branch-Informationen

### **4. Git-Commit-Manager (`git-commit.js`)**
```javascript
const GitCommitManager = new GitCommitManager(workspacePath);
const result = await commitManager.addFiles(['file1.js', 'file2.js']);
const result = await commitManager.commit('Add new feature');
const result = await commitManager.push();
const result = await commitManager.pull();
const result = await commitManager.fetch();
```

**Features:**
- üìÅ Dateien zum Staging hinzuf√ºgen
- üíæ Commits erstellen
- üöÄ Push/Pull/Fetch-Operationen
- üìù Commit-Historie
- üîç Diff-Ansicht
- ‚ö° Add-Commit-Push Workflow

### **5. Git-Stash-Manager (`git-stash.js`)**
```javascript
const GitStashManager = new GitStashManager(workspacePath);
const result = await stashManager.stash('WIP: feature in progress');
const result = await stashManager.stashPop();
const stashes = await stashManager.stashList();
```

**Features:**
- üì¶ √Ñnderungen stashen
- üîÑ Stash anwenden (pop/apply)
- üìã Stash-Liste
- üóëÔ∏è Stash l√∂schen
- üåø Branch aus Stash erstellen
- üìÅ Spezifische Dateien stashen

### **6. Git-Reset-Manager (`git-reset.js`)**
```javascript
const GitResetManager = new GitResetManager(workspacePath);
const result = await resetManager.softReset('HEAD~1');
const result = await resetManager.hardReset('HEAD~1');
const result = await resetManager.mixedReset('HEAD~1');
const result = await resetManager.revertCommit('abc123');
```

**Features:**
- üîÑ Soft Reset (√Ñnderungen behalten)
- üóëÔ∏è Hard Reset (√Ñnderungen verwerfen)
- üîÄ Mixed Reset (Standard)
- ‚Ü©Ô∏è Commit revertieren
- üìã Reflog f√ºr Recovery
- üõ°Ô∏è Reset-Sicherheitspr√ºfung

### **7. Git-Remote-Manager (`git-remote.js`)**
```javascript
const GitRemoteManager = new GitRemoteManager(workspacePath);
const remotes = await remoteManager.listRemotes();
const result = await remoteManager.addRemote('upstream', 'https://github.com/user/repo.git');
const result = await remoteManager.setRemoteUrl('origin', 'https://github.com/user/repo.git');
```

**Features:**
- üåê Remote-Repositories verwalten
- ‚ûï Remote hinzuf√ºgen/entfernen
- üîÑ Remote-URL √§ndern
- üìã Remote-Branches auflisten
- üîó Upstream-Branches setzen
- üìä Remote-Status (ahead/behind)

### **8. Git-Operations-Manager (`run.js`)**
```javascript
const GitOperationsManager = new GitOperationsManager(config, log);
await gitManager.initialize();
const result = await gitManager.addFiles(['file1.js', 'file2.js']);
const result = await gitManager.commit('Add new feature');
const result = await gitManager.push();
```

**Features:**
- üéØ Zentrale Git-Verwaltung
- üîó WorkspaceFinder-Integration
- üìä Vollst√§ndige Git-Info
- üöÄ Automatisierte Workflows

## üöÄ **Verwendung**

### **In der Hauptworkflow-Datei (`pidea-spark.js`)**

```javascript
// Git-Status pr√ºfen
const gitStatus = await this.checkGitStatus();

// Branches auflisten
const branches = await this.getGitBranches();

// Neuen Branch erstellen
const result = await this.createGitBranch('feature/new-feature');

// Branch wechseln
const result = await this.switchGitBranch('main');

// √Ñnderungen committen und pushen
const result = await this.commitAndPush('Add new feature', ['file1.js']);
```

### **Standalone-Verwendung**

```javascript
// Git-Status pr√ºfen
import GitStatusChecker from './automation/git-operations/git-status.js';
const checker = new GitStatusChecker('/path/to/workspace');
const info = await checker.getFullInfo();

// Branch-Management
import GitBranchManager from './automation/git-operations/git-branches.js';
const branchManager = new GitBranchManager('/path/to/workspace');
const branches = await branchManager.getAllBranches();

// Commit-Operationen
import GitCommitManager from './automation/git-operations/git-commit.js';
const commitManager = new GitCommitManager('/path/to/workspace');
const result = await commitManager.addCommitPush(['file1.js'], 'Update feature');

// Stash-Operationen
import GitStashManager from './automation/git-operations/git-stash.js';
const stashManager = new GitStashManager('/path/to/workspace');
const result = await stashManager.stash('WIP: feature in progress');

// Reset-Operationen
import GitResetManager from './automation/git-operations/git-reset.js';
const resetManager = new GitResetManager('/path/to/workspace');
const result = await resetManager.softReset('HEAD~1');

// Remote-Operationen
import GitRemoteManager from './automation/git-operations/git-remote.js';
const remoteManager = new GitRemoteManager('/path/to/workspace');
const remotes = await remoteManager.listRemotes();
```

## üìä **Beispiel-Ausgaben**

### **Git-Status-Check:**
```
üîç Checking Git status...
‚úÖ Git repository found in: /home/user/cursor-workspace
üìã Current branch: main
üìä Status: 3 changes
‚ö†Ô∏è Repository has uncommitted changes
   Modified: 2
   Added: 1
   Deleted: 0
   Untracked: 0
```

### **Branch-Liste:**
```
üåø Getting Git branches...
‚úÖ Found 3 local and 5 remote branches
üìã Current branch: main

üìã Local Branches:
‚Üí main
  feature/new-feature
  bugfix/issue-123

üåê Remote Branches:
  develop
  staging
  release/v1.0.0
```

### **Commit-Operationen:**
```
üíæ Committing and pushing changes...
‚úÖ Added files to staging: file1.js file2.js
‚úÖ Committed with message: Add new feature
‚úÖ Pushed to remote origin
```

### **Stash-Operationen:**
```
üì¶ Git Stash Operations Test:
==============================
Has stashes: true
üì¶ Found 2 stashes

üìã Stash list:
  stash@{0}: WIP: feature in progress
  stash@{1}: WIP: bugfix work
```

### **Reset-Operationen:**
```
üîÑ Git Reset Operations Test:
=============================
üìã Current commit: abc1234
üõ°Ô∏è Reset safe: false
‚ö†Ô∏è Has uncommitted changes - reset may be dangerous

üìù Recent commits:
  0: abc1234 Update feature
  1: def5678 Fix bug
  2: ghi9012 Initial commit
```

### **Remote-Operationen:**
```
üåê Git Remote Operations Test:
==============================
üìã Found 2 remotes:
  origin:
    fetch: https://github.com/user/repo.git
    push: https://github.com/user/repo.git
  upstream:
    fetch: https://github.com/original/repo.git
    push: https://github.com/original/repo.git

üìä Remote status:
  Branch: main
  Ahead: 2
  Behind: 0

üåø Remote branches (origin): 5
  origin/main
  origin/develop
  origin/feature/new-feature
```

## üîß **Konfiguration**

### **WorkspaceFinder-Integration**
```javascript
const config = {
    cdpPort: 9222,  // Cursor CDP Port
    projectRoot: '/path/to/workspace'
};
```

### **Logging**
```javascript
const log = (message, level = 'INFO') => {
    console.log(`[${level}] ${message}`);
};
```

## üõ°Ô∏è **Fehlerbehandlung**

Alle Module bieten robuste Fehlerbehandlung:

```javascript
const result = await gitManager.createBranch('test');
if (result.error) {
    console.log(`‚ùå Error: ${result.error}`);
} else {
    console.log(`‚úÖ Success: ${result.message}`);
}
```

## üîÑ **WorkspaceFinder-Integration**

Das System erkennt automatisch das Cursor Workspace:

1. **Workspace gefunden**: Git-Operationen im korrekten Repository
2. **Kein Workspace**: Fallback auf lokales Verzeichnis
3. **Cursor nicht erreichbar**: Automatischer Fallback

## üìù **Beispiele f√ºr Automation-Workflows**

### **Automatisches Committing nach Task-Abschluss:**
```javascript
// Nach erfolgreicher Task-Ausf√ºhrung
const gitStatus = await this.checkGitStatus();
if (gitStatus.isGitRepo && gitStatus.status.status.total > 0) {
    await this.commitAndPush(`Complete task: ${task.name}`);
}
```

### **Feature-Branch-Workflow:**
```javascript
// Neuen Feature-Branch erstellen
await this.createGitBranch(`feature/${task.name}`);

// Task ausf√ºhren
await this.executeTask(task);

// √Ñnderungen committen
await this.commitAndPush(`Implement ${task.name}`);

// Zur√ºck zu main
await this.switchGitBranch('main');
```

### **Stash-Workflow f√ºr Konflikte:**
```javascript
// √Ñnderungen stashen
const stashResult = await stashManager.stash('WIP: before pull');

// Pull ausf√ºhren
const pullResult = await commitManager.pull();

// Stash wieder anwenden
const popResult = await stashManager.stashPop();
```

### **Reset-Workflow f√ºr Fehlerbehebung:**
```javascript
// Pr√ºfen ob Reset sicher ist
const resetSafety = await resetManager.isResetSafe();

if (resetSafety.isSafe) {
    // Soft reset f√ºr letzte √Ñnderungen
    await resetManager.softReset('HEAD~1');
} else {
    // Stash erstellen vor Reset
    await stashManager.stash('Before reset');
    await resetManager.hardReset('HEAD~1');
}
```

### **Remote-Workflow f√ºr Upstream-Updates:**
```javascript
// Upstream hinzuf√ºgen
await remoteManager.addRemote('upstream', 'https://github.com/original/repo.git');

// Fetch von Upstream
await remoteManager.fetchRemote('upstream');

// Branch erstellen f√ºr Update
await branchManager.createBranch('update-from-upstream');

// Merge von Upstream
await branchManager.mergeBranch('upstream/main');
```

## üéâ **Vorteile**

- ‚úÖ **Workspace-aware**: Funktioniert im korrekten Cursor Workspace
- üîÑ **R√ºckw√§rtskompatibel**: Fallback auf lokales Verzeichnis
- üìä **Detaillierte Informationen**: Umfassende Git-Status-Info
- üõ°Ô∏è **Robuste Fehlerbehandlung**: Graceful Degradation
- üöÄ **Einfache Integration**: Plug-and-play in bestehende Workflows
- üìù **Umfassende Dokumentation**: Klare API und Beispiele
- üéØ **Modulare Architektur**: Jede Operation in separater Datei
- ‚ö° **Vollst√§ndige Git-Unterst√ºtzung**: Alle wichtigen Git-Befehle
- üîó **WorkspaceFinder-Integration**: Automatische Workspace-Erkennung

## üìã **Git-Befehle √úbersicht**

### **Basis-Operationen:**
- `git status` ‚Üí `GitStatusChecker.getStatus()`
- `git add` ‚Üí `GitCommitManager.addFiles()`
- `git commit` ‚Üí `GitCommitManager.commit()`
- `git push` ‚Üí `GitCommitManager.push()`
- `git pull` ‚Üí `GitCommitManager.pull()`
- `git fetch` ‚Üí `GitCommitManager.fetch()`

### **Branch-Operationen:**
- `git branch` ‚Üí `GitBranchManager.getAllBranches()`
- `git checkout -b` ‚Üí `GitBranchManager.createBranch()`
- `git checkout` ‚Üí `GitBranchManager.switchBranch()`
- `git merge` ‚Üí `GitBranchManager.mergeBranch()`

### **Stash-Operationen:**
- `git stash` ‚Üí `GitStashManager.stash()`
- `git stash pop` ‚Üí `GitStashManager.stashPop()`
- `git stash list` ‚Üí `GitStashManager.stashList()`

### **Reset-Operationen:**
- `git reset --soft` ‚Üí `GitResetManager.softReset()`
- `git reset --hard` ‚Üí `GitResetManager.hardReset()`
- `git reset --mixed` ‚Üí `GitResetManager.mixedReset()`
- `git revert` ‚Üí `GitResetManager.revertCommit()`

### **Remote-Operationen:**
- `git remote -v` ‚Üí `GitRemoteManager.listRemotes()`
- `git remote add` ‚Üí `GitRemoteManager.addRemote()`
- `git remote set-url` ‚Üí `GitRemoteManager.setRemoteUrl()`
- `git fetch` ‚Üí `GitRemoteManager.fetchRemote()`

---

**Hinweis**: Alle Git-Operationen verwenden `execSync` f√ºr synchrone Ausf√ºhrung und bessere Integration in Automation-Workflows. 